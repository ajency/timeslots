/*! aj-timeslots - v0.0.0 - 2015-02-06
* http://eatimeline.parseapp.com/example/
* Copyright (c) 2015 Elroy Antao (elroyantao@gmail.com); Licensed MIT 
verdor file for jQuery , Backbone, Marionette, underscore, underscore.string */

var __indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};(function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;return r=this,t=[],e=function(b,d){var e,f,g,h,i,j,k,n,o,p,q;for(k=d.timeArray,o=b.find(".timeline-interval-region").width(),h=l(k,o),f=p=0,q=k.length;q>p;f=++p)j=k[f],0!==f?(i=j-k[f-1],n=k[k.length-1]-k[0],g=Math.floor(i*h),e=m(),b.find(".timeline-slot-region").append("<div data-slot='"+(f-1)+"' class='slot' style='background-color: "+e+"; width: "+g+"px'></div>"),c(b,k[f-1],j,e,f-1),d.showSlotTimes&&b.find(".timeline-slot-region").append(f<k.length-1?"<div  class='slot-interval' ><div class='slot-interval-time'>"+moment.unix(j).format("H:mm")+"</div></div>":"<div  class='slot-interval' ><div class='slot-interval-time last'>"+moment.unix(j).format("H:mm")+"</div></div>")):d.showSlotTimes&&b.find(".timeline-slot-region").append("<div  class='slot-interval' > <div class='slot-interval-time first'> "+moment.unix(j).format("H:mm")+" </div> </div>");return a(".overflow-timeline").draggable({axis:"x",scroll:!1,drag:function(b,c){var d,e,f;return b.stopPropagation(),d=a(".overflow-timeline").width(),e=a(".overflow-timeline").parent().width(),f=c.position.left,e-d>f&&(c.position.left=e-d),f>0?c.position.left=0:void 0}}),a(".overflow-timeline").css("display","inline-table")},c=function(a,b,c,d,e){var f,g;return g=moment.unix(c).diff(1e3*b),f="",moment.duration(g).hours()&&(f+=""+moment.duration(g).hours()+" hr"),moment.duration(g).hours()&&moment.duration(g).minutes()&&(f+=", "),moment.duration(g).minutes()&&(f+=""+moment.duration(g).minutes()+" min"),a.find(".time-description").append("<div data-slot='"+e+"' class='slot'><div class='slot-time' style='background-color:"+d+"'>"+f+"</div></div>")},o=[1,1,1,1,1,1],m=function(){var a,b,c,d,e;for(c="6789ABCDEF".split(""),a="#",b=e=0;5>=e;b=++e)b%2?o[b]=(o[b]+Math.floor(10*Math.random()))%10:(d=(o[b]-Math.floor(10*Math.random()))%10,o[b]=0>d?10+d:d),a+=c[o[b]];return __indexOf.call(t,a)<0?t.push(a):a=m(),a},u=function(a){var b,c,d,e;for(d=0,e=a.length;e>d;d++){if(c=a[d],b&&b!==moment.unix(c).format("L"))return!1;b=moment.unix(c).format("L")}return!0},v=function(a){var b,c,d,e;if(!Array.isArray(a))return!1;if(a.length<2)return!1;for(b=i(),d=0,e=a.length;e>d;d++)if(c=a[d],1262304e3>c||c>b)return!1;return u(a)?!0:!1},i=function(){var a;return a=(new Date).getTime()/1e3,Math.floor(a)},g=function(a){return a.html("	<div class='timeline'> <div class='overflow-timeline'> <div class='timeline-interval-region' style='height: 25px; position: relative;'></div> <div class='timeline-slot-region'></div> </div> </div> <div class='time-description'></div>")},n=function(a){return a[0]},j=function(a){return a[a.length-1]},k=function(a){var b,c,d,e,f,g,h,i,k,l,m,o;for(i=n(a),c=j(a),d=[],h=moment.unix(i).hour(),b=moment.unix(c).hour(),o=c-i,k=h+1,l=moment.unix(i);b>=k;)l.hour(k),m=l.unix(),g=m-i,f=100*g/o,e=l.format("ha"),f>5&&95>f&&d.push({label:e,percentage:f}),k+=1;return d},p=function(a,b){var c,d,e,f,g,i,j,k,l;for(g=a.find(".timeline-interval-region").width(),c=h(g,b.length),l=[],d=i=0,j=b.length;j>i;d=++i)e=b[d],k=d+1,__indexOf.call(c,k)>=0?(f=e.percentage*g/100-20,l.push(a.find(".timeline-interval-region").append("<div class='time-interval' style='left : "+e.percentage+"%'><div>"+e.label+"</div></div>"))):l.push(void 0);return l},h=function(a,b){var c,d,e,f,g,h;for(d=a/50,g=b,e=Math.ceil(b/d),c=[],f=h=1;b>=1?b>=h:h>=b;f=b>=1?++h:--h)f%e===0&&0!==f&&c.push(f);return c},l=function(a,b){var c,d,e,f,g,h,i,j;for(g=1e5,c=i=0,j=a.length;j>i;c=++i)h=a[c],0!==c&&g>h-a[c-1]&&(g=h-a[c-1]);return e=40/g,f=b/(a[a.length-1]-a[0]),d=e>f?e:f},d=function(b,c){var d;return d=b.find(".time-description .slot"),d.on("swiperight",function(d){var e,f,g,h;if(!a(d.target).closest(".time-description").hasClass("combine-parent")&&a(d.target).hasClass("slot"))return g=parseInt(a(d.target).attr("data-slot")),h=c.timeArray[g],f=c.timeArray[g+1],e=moment.unix(f).diff(moment.unix(h),"minutes"),console.log(e),console.log("split"),bootbox.dialog({title:"Create new slot",message:"<div> <span> Start time : "+moment.unix(h).format("h:mm a")+" </span> </div><div> <span> End time : "+moment.unix(f).format("h:mm a")+" </span> </div> <div><span>Duration : "+e+' minutes</span></div> <div class="split-time"> Enter new slot time <span> <input type="number" maxlength="2" min="0" max="24" class="new-slot"/> </span>  minutes <div> add new slot at the </br> <input type="radio" name="newSlotPosition" value="start" checked>Start <input type="radio" name="newSlotPosition" value="end">End </div> </div>',buttons:{cancel:{label:"Cancel",className:"btn-failure"},split:{label:"Split",className:"btn-primary",callback:function(){var d,g,i,j;return j=parseInt(a(".split-time .new-slot").val()),i=j>0&&e>j?j:"",""!==i?(d=moment.unix(h),console.log(a('input[name="newSlotPosition"]').val()),"end"===a('input[name="newSlotPosition"]:checked').val()?d.add(e-i,"m"):d.add(i,"m"),g=d.unix(),g>h&&f>g?(c.timeArray.push(g),c.timeArray.sort(),null!=c.onSplitSlot&&"function"==typeof c.onSplitSlot&&c.onSplitSlot.call(this,c.timeArray),b.trigger("refresh")):void 0):void 0}}}})}),d.on("swipeleft",function(d){var e,g,h;if(!a(d.target).closest(".time-description").hasClass("combine-parent")&&a(d.target).hasClass("slot")&&(h=parseInt(a(d.target).attr("data-slot")),e=0===h?!0:!1,g=h===c.timeArray.length-2?!0:!1,!e||!g))return a(d.target).closest(".time-description").addClass("combine-parent"),a(d.target).addClass("combine-current"),a(d.target).append('<span class="cancel-combine"><i class="glyphicon glyphicon-remove"></i></span>'),e||a('.time-description.combine-parent .slot[data-slot="'+(h-1)+'"]').addClass("combine-neighbour"),g||a('.time-description.combine-parent .slot[data-slot="'+(h+1)+'"]').addClass("combine-neighbour"),a(".time-description.combine-parent .slot.combine-neighbour").on("tap",f.bind(this,b,c,h)),a(".time-description.combine-parent .slot.combine-current .cancel-combine").on("tap",s.bind(this,b))})},f=function(b,c,d,e){var f;return console.log("combine"),f=parseInt(a(e.target).attr("data-slot")),d>f?c.timeArray.splice(d,1):f>d&&c.timeArray.splice(d+1,1),s(b),null!=c.onCombineSlot&&"function"==typeof c.onCombineSlot&&c.onCombineSlot.call(this,c.timeArray),b.trigger("refresh")},s=function(){return a(".time-description.combine-parent .slot.combine-current .cancel-combine").off().remove(),a(".time-description.combine-parent .slot.combine-neighbour").off("tap").removeClass("combine-neighbour"),a(".time-description.combine-parent .slot.combine-current").removeClass("combine-current"),a(".time-description.combine-parent ").removeClass("combine-parent")},q=function(a){var b,c;if(b=this,!v(a.timeArray))throw"The timeArray passed is not valid";return a.timeArray.sort(),g(b),b.find(".timeline").css({width:"100%","overflow-x":"hidden"}),c=k(a.timeArray),e(b,a),p(b,c),d(b,a)},b=function(){function a(a){null==a.showSlotTimes&&(a.showSlotTimes=!0),q.call(this,a),this.on("refresh",function(b){return function(){return q.call(b,a)}}(this))}return a}(),"undefined"!=typeof TEST_ENV&&null!==TEST_ENV&&(r.createChildRegion=g,r.validateSameDayTime=u,r.getStartTime=n,r.getEndTime=j,r.getHourArray=k,r.getAllowedIntervalLabel=h,r.getPixelPerSecond=l,r.validateTimeArray=v),a.fn.timeline=b}).call(this,jQuery);
//# sourceMappingURL=aj-timeslot.min.js.map